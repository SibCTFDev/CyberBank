Всем привет мы ...

На SibirCTF вам удалось порешать сервис разработанный нашей командой.
Сервис представлял из себя Биржу по покупке кибервалюты.

Изначально самым простым способом получить флаг была возможность создать несколько пользователей и покупая продукты одного пользователя собирать у него деньги -> на которые в последствии покупать флаги 

В сервисе было допушенно несколько недочётов разной степени критичности:
1) В коде сервиса были оставлены логин и пароль от базы данных которая торчит на ружу
![alt text](<images/Снимок экрана 2025-03-19 в 14.46.58.png>)
2) Если внимательно прочитать код сервиса то можно заметить что криптография которой шифровались данные сервиса - на самом деле и не криптография вовсе 

Наверное вас должна была напугать обфускация программного кода , но на самом деле так как это TS можно было легко расшифровать данные просто перенеся код дешифратора в сплоит или исполнив его в консоли браузера
![alt text](<images/Снимок экрана 2025-03-19 в 14.52.43.png>)

3) Следующие проблемой стал алгоритм генерации картинки - так как алгоритм прятал внутри картинки флаг вы могли парсить картинки и извлекать из них содержимое
![alt text](<images/Снимок экрана 2025-03-19 в 14.49.28.png>)
4) Уязвимость которая нами не задумывалась Изначально но вот как её описал разработчик данного сервиса:
```
И если пользователь купит продукт на все бабки (то есть в функцию передастся 0 как обновленный баланс), то он получить продукт бесплатно, потому что 0 == null -> true. Люблю
```
![alt text](<images/Снимок экрана 2025-03-19 в 14.54.53.png>)

5) Idor через механизм веб-сокетов
6) Самая интересная уязвимость вы могли в коде увидеть регулярное выражение которое должно было вас смутить и натолкнуть на мысль что разработчики заложили в сервис redos и это правда , но на самом деле это цепочка уязвимостей:
`redos -> Race Condition ` эксплуатируя данный недостаток вы могли накручивать деньги на нужном вам аккаунте.

Как результат у нас получилась вот такая карта недостатков в сервисе:
![alt text](images/image.png)
